<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>销售管理</title>
		<link href="../themes/css/mui.min.css" rel="stylesheet" />
		<link href="../themes/css/swiper-4.3.3.min.css" rel="stylesheet" />
		<link href="../themes/css/iconfont.css" rel="stylesheet" />
		<link href="../themes/css/app.css" rel="stylesheet" />
		<style>
			html,
			body,#app {
				position: relative;
				height: 100%;
			}
			
			html {
				overflow: hidden;
			}
		</style>
	</head>

	<body>
		<div id="app">
			<div id="top" class="fyt-cus-swiper">
				<div class="swiper-container" id="nav">
					<div class="swiper-wrapper">
						<div class="swiper-slide">
							<span style="color: rgb(255, 80, 83)">普通销售</span>
						</div>
						<div class="swiper-slide">
							<span>打折销售</span>
						</div>	
						<div class="swiper-slide">
							<span>满减销售</span>
						</div>	
						<div id="bar" class="bar">
							<div class="color"></div>
						</div>
					</div>					
				</div>
			</div>
			<div class="swiper-container" id="page">
				<div class="swiper-wrapper sale-wall">
					<div class="swiper-slide slidepage">
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
					</div>
					<div class="swiper-slide slidepage">
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
					</div>
					<div class="swiper-slide slidepage">
						<div class="sale-item">
							<div class="title">订单：170205446654<span>￥160</span></div>
							<div class="sale-info">
								<h4>这是标题标题标题标题</h4>
								<p>条形码：ADAFSA-5644-0140</p>
								<span>5件</span>
							</div>
							<div class="footer"><span><i class="iconfont icon-riqi"></i>2017-07-02 10:25:45</span><button type="button" class="mui-btn mui-btn-success mui-btn-outlined">详情</button></div>
						</div>
					</div>
				</div>
			</div>
			
			<div class="page-cover" @click="closeWhere"></div>
			<div class="fyt-chwall">
				<div class="mui-scroll">
					<h5 class="sel_time"><i class="iconfont icon-riqi"></i><span @click="openDate(1)">{{whereParm.btime}}</span></h5>
					<h5 class="sel_time"><i class="iconfont icon-riqi"></i><span @click="openDate(2)">{{whereParm.etime}}</span></h5>
					<div class="cs-wall mui-clearfix">
					</div>
					<h5>品牌<span></span></h5>
					<div class="cd-wall">
						<span @click="selBrank()" :class="{cur:true}">测试品牌</span>
						<span @click="selBrank()" :class="{cur:false}">测试品牌</span>
						<span @click="selBrank()" :class="{cur:false}">测试品牌</span>
						<span @click="selBrank()" :class="{cur:false}">测试品牌</span>
					</div>
				</div>
				<div class="fyt-foot-button mui-clearfix">
					<span class="cz" @click="resetWhere">重置</span><span class="success" @click="findWhere">确定</span>
				</div>
			</div>
			
		</div>		
		<script src="../themes/js/mui.min.js"></script>
		<script src="../themes/js/swiper-4.3.3.min.js"></script>
		<script src="../themes/js/zepto.min.js"></script>
		<script src="../themes/js/vue.js"></script>
		<script src="../themes/js/app.js"></script>
		<script>
			var _self,isOpenWhere=false;
			mui.init();
			mui.plusReady(function() {	
				//plusReady();
				window.addEventListener('customEvent',function(event){
					if(!isOpenWhere){
						os.openWhere();
					}else{
						os.closeWhere();
					}				   	
				})
			});
			function plusReady() {
				_self = plus.webview.currentWebview();
				_self.setPullToRefresh({
					support: true,
					height: '50px',
					range: '150px',
					style: 'circle',
					offset: '45px'
				}, pulldownRefresh);
			}

			function pulldownRefresh() {				
				setTimeout(function() {
					_self.endPullToRefresh();
				}, 500);
			}
			var vm = new Vue({
				el: "#app",
				data: {
					whereParm:{
						btime:'请选择开始时间',
						etime:'请选择结束时间',
						blank:''
					}
				},
				created:function(){
					$(".cd-wall span").click(function() {
						$(this).addClass("cur").siblings().removeClass('cur');
					});
				},
				methods: {
					findWhere:function(){
						//确定查询
						os.closeWhere();
					},
					wheres:function(){						
						os.openWhere();
					},
					openDate:function(m){
						os.pickDate(m);
					},
					closeWhere:function(){
						os.closeWhere();
					},
					resetWhere:function(){
						this.whereParm.btime='请选择开始时间';
						this.whereParm.etime='请选择结束时间';
						this.whereParm.blank='';
					},
					selBrank:function(){
						
					}
				}
			});

			var os={
				closeWhere:function(){
					$('.page-cover,.fyt-chwall').hide(600);
					isOpenWhere=false;
				},
				openWhere:function(){					
					$('.page-cover,.fyt-chwall').show(600);
					isOpenWhere=true;
				},
				pickDate:function(objs){
					var dDate = new Date();
					var minDate = new Date();
					minDate.setFullYear(2010, 0, 1);
					var maxDate = new Date();
					maxDate.setFullYear(2050, 12, 31);
					plus.nativeUI.pickDate(function(e) {
						var d = e.date;
						if(objs==1){
							vm.whereParm.btime=d.getFullYear() + "-" + (d.getMonth() + 1) + "-" + d.getDate();
						}
						if(objs==2){
							vm.whereParm.etime=d.getFullYear() + "-" + (d.getMonth() + 1) + "-" + d.getDate();
						}
					}, function(e) {
					}, {
						title: "",
						date: dDate,
						minDate: minDate,
						maxDate: maxDate
					});
				}
			}
			
			barwidth = 60 //导航粉色条的长度px
			tSpeed = 300 //切换速度300ms
			var curIndex=0,navSwiper = new Swiper('#nav', {
				slidesPerView: 3,
				freeMode: true,
				on: {
					init: function() {
						navSlideWidth = this.slides.eq(0).css('width'); //导航字数需要统一,每个导航宽度一致
						bar = this.$el.find('.bar')
						bar.css('width', navSlideWidth)
						bar.transition(tSpeed)
						navSum = this.slides[this.slides.length - 1].offsetLeft //最后一个slide的位置

						clientWidth = parseInt(this.$wrapperEl.css('width')) //Nav的可视宽度
						navWidth = 0
						for(i = 0; i < this.slides.length; i++) {
							navWidth += parseInt(this.slides.eq(i).css('width'))
						}

						topBar = this.$el.parents('body').find('#top') //页头

					},

				},
			});
			var pageSwiper = new Swiper('#page', {
				watchSlidesProgress: true,
				resistanceRatio: 0,
				on: {
					touchMove: function() {
						progress = this.progress
						bar.transition(0)
						bar.transform('translateX(' + navSum * progress + 'px)')
						//粉色255,72,145灰色51,51,51
						for(i = 0; i < this.slides.length; i++) {
							slideProgress = this.slides[i].progress
							if(Math.abs(slideProgress) < 1) {
								r = Math.floor((255 - 51) * (1 - Math.pow(Math.abs(slideProgress), 2)) + 51)
								g = Math.floor((80 - 51) * (1 - Math.pow(Math.abs(slideProgress), 2)) + 51)
								b = Math.floor((83 - 51) * (1 - Math.pow(Math.abs(slideProgress), 2)) + 51)
								navSwiper.slides.eq(i).find('span').css('color', 'rgba(' + r + ',' + g + ',' + b + ',1)')
							}
						}
					},
					transitionStart: function() {
						curIndex = this.activeIndex;
						activeSlidePosition = navSwiper.slides[curIndex].offsetLeft
						//释放时导航粉色条移动过渡
						bar.transition(tSpeed)
						bar.transform('translateX(' + activeSlidePosition + 'px)')
						//释放时文字变色过渡
						navSwiper.slides.eq(curIndex).find('span').transition(tSpeed)
						navSwiper.slides.eq(curIndex).find('span').css('color', 'rgba(255,80,83,1)')
						if(curIndex > 0) {
							navSwiper.slides.eq(curIndex - 1).find('span').transition(tSpeed)
							navSwiper.slides.eq(curIndex - 1).find('span').css('color', 'rgba(51,51,51,1)')
						}
						if(curIndex < this.slides.length) {
							navSwiper.slides.eq(curIndex + 1).find('span').transition(tSpeed)
							navSwiper.slides.eq(curIndex + 1).find('span').css('color', 'rgba(51,51,51,1)')
						}
						

					},
				}
			});

			navSwiper.$el.on('touchstart', function(e) {
				e.preventDefault() //去掉按压阴影
			})
			navSwiper.on('tap', function(e) {
				curIndex = this.clickedIndex;
				clickSlide = this.slides.eq(curIndex);
				pageSwiper.slideTo(curIndex, 0);
				this.slides.find('span').css('color', 'rgba(51,51,51,1)');
				clickSlide.find('span').css('color', 'rgba(255,80,83,1)');		
				os.closeWhere();
				isOpenWhere=false;
			})
		</script>
	</body>

</html>